/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";function e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var t={read:function(e){return e.replace(/%3B/g,";")},write:function(e){return e.replace(/;/g,"%3B")}};const n=function n(r,i){function o(n,o,a){if("undefined"!=typeof document){"number"==typeof(a=e({},i,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),n=t.write(n).replace(/=/g,"%3D"),o=r.write(String(o),n);var u="";for(var c in a)a[c]&&(u+="; "+c,!0!==a[c]&&(u+="="+a[c].split(";")[0]));return document.cookie=n+"="+o+u}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],i={},o=0;o<n.length;o++){var a=n[o].split("="),u=a.slice(1).join("="),c=t.read(a[0]).replace(/%3D/g,"=");if(i[c]=r.read(u,c),e===c)break}return e?i[e]:i}},remove:function(t,n){o(t,"",e({},n,{expires:-1}))},withAttributes:function(t){return n(this.converter,e({},this.attributes,t))},withConverter:function(t){return n(e({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(r)}})}(t,{path:"/"});function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"url","http://localhost/ci-jwt-api/"),i(this,"routes",{BASE:"index",GET_TOKEN:"get-token",VERIFY_TOKEN:"verify-token"}),i(this,"target",$("#api")),i(this,"input",$("#data")),this.init(),this.verifyKey(),this.getToken(),this.verifyToken()}var t,o;return t=e,o=[{key:"console",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){console.log("Main.js")}))},{key:"init",value:function(){var e=this,t=e._authorizationRequestRoute();$.ajax({url:t,type:"POST",cache:!1,data:{PUBLIC_KEY:localStorage.getItem("PUBLIC_KEY")},dataType:"json",beforeSend:function(){e.target.prepend('<div class="loader"></div>')}}).done((function(t,r,i){e.target.find(".loader").remove(),e.target.find("#api-response").html("<p>"+JSON.stringify(t)+"</p>"),n.set("AUTHORIZATION_GRANT",t.AUTHORIZATION_GRANT)})).fail((function(t,n,r){e.target.find(".loader").remove(),e.target.find("#api-response").html("<p>"+JSON.stringify(r)+"</p>")}))}},{key:"verifyKey",value:function(){var e=this;$(document).on("click","#VERIFY_KEY",(function(t){t.preventDefault(),e.init()}))}},{key:"getToken",value:function(){var e=this;$(document).on("click","#GET_TOKEN",(function(t){t.preventDefault();var r=e._route(this);$.ajax({url:r,type:"POST",cache:!1,data:{var:$("#input-value").val(),AUTHORIZATION_GRANT:n.get("AUTHORIZATION_GRANT")},dataType:"json",beforeSend:function(){e.target.prepend('<div class="loader"></div>')}}).done((function(t,r,i){e.target.find(".loader").remove(),e.target.find("#api-response").html("<p>"+JSON.stringify(t)+"</p>"),n.set("jwt-value",t.Token)})).fail((function(t,n,r){e.target.find(".loader").remove(),e.target.find("#api-response").html("<p>"+JSON.stringify(r)+"</p>")}))}))}},{key:"verifyToken",value:function(){var e=this;$(document).on("click","#VERIFY_TOKEN",(function(t){t.preventDefault();var r=e._route(this);$.ajax({url:r,type:"POST",cache:!1,dataType:"json",data:{AUTHORIZATION_GRANT:n.get("AUTHORIZATION_GRANT")},beforeSend:function(){e.target.prepend('<div class="loader"></div>')},headers:{Authorization:"Bearer "+n.get("jwt-value")}}).done((function(t,n,r){e.target.find(".loader").remove(),e.target.find("#api-response").html("<p>"+JSON.stringify(t)+"</p>")})).fail((function(t,n,r){e.target.find(".loader").remove(),e.target.find("#api-response").html("<p>"+JSON.stringify(r)+"</p>")}))}))}},{key:"successFunction",value:function(e,t,n){}},{key:"failedFunction",value:function(e,t,n){}},{key:"_route",value:function(e){var t=this,n=$(e).attr("id");if(n in t.routes)return t.url+t.routes[n];alert("Route does not exist !")}},{key:"_authorizationRequestRoute",value:function(){return this.url+this.routes.BASE}}],o&&r(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();const a=o;$(document).ready((function(){fetch("assets/keys/public.pem").then((function(e){return e.text()})).then((function(e){localStorage.setItem("PUBLIC_KEY",e),(new a).console()})),console.log("Script.js");var e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);$("#input-value").val(e)}))})();